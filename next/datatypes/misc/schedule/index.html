<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="search" type="application/opensearchdescription+xml" title="ZIO" href="/opensearch.xml">
<link rel="stylesheet" href="/css/prism/prism-material-dark.css"><title data-react-helmet="true">Schedule | ZIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://zio.dev/next/datatypes/misc/schedule"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Schedule | ZIO"><meta data-react-helmet="true" name="description" content="A Schedule[Env, In, Out] is an immutable value that describes a recurring effectful schedule, which runs in some environment Env, after consuming values of type In (errors in the case of retry, or values in the case of repeat) produces values of type Out, and in every step based on input values and the internal state decides to halt or continue after some delay d."><meta data-react-helmet="true" property="og:description" content="A Schedule[Env, In, Out] is an immutable value that describes a recurring effectful schedule, which runs in some environment Env, after consuming values of type In (errors in the case of retry, or values in the case of repeat) produces values of type Out, and in every step based on input values and the internal state decides to halt or continue after some delay d."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://zio.dev/next/datatypes/misc/schedule"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/next/datatypes/misc/schedule" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zio.dev/next/datatypes/misc/schedule" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.b999c5ee.css">
<link rel="preload" href="/assets/js/runtime~main.7f3e08ea.js" as="script">
<link rel="preload" href="/assets/js/main.84c81040.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/navbar_brand.png" alt="ZIO" class="themedImage_TMUO themedImage--dark_uzRr"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/version-1.x/overview/overview_index">Overview</a><a class="navbar__item navbar__link" href="/version-1.x/datatypes/index">Data Types</a><a class="navbar__item navbar__link" href="/version-1.x/usecases/usecases_index">Use Cases</a><a class="navbar__item navbar__link" href="/version-1.x/howto/index">How to</a><a class="navbar__item navbar__link" href="/version-1.x/resources/index">Resources</a><a class="navbar__item navbar__link" href="/version-1.x/about/about_index">About</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/next/overview/overview_index">ZIO 2.x (WIP)</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/next/datatypes/misc/schedule">ZIO 2.x (WIP)</a></li><li><a class="dropdown__link" href="/version-1.x/datatypes/misc/schedule">ZIO 1.x</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Core Data Types</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contextual Types</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concurrency</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Resource Management</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Streaming</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Metrics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Miscellaneous</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/datatypes/misc/chunk">Chunk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/next/datatypes/misc/schedule">Schedule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/datatypes/misc/supervisor">Supervisor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/next/datatypes/misc/zstate">ZState</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->ZIO<!-- --> <b>ZIO 2.x (WIP)</b> version.</div><div class="margin-top--md">See here for the <b><a href="/version-1.x/datatypes/misc/schedule">latest version</a></b> of ZIO (<!-- -->ZIO 1.x<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->ZIO 2.x (WIP)</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Schedule</h1></header><p>A <code>Schedule[Env, In, Out]</code> is an <strong>immutable value</strong> that <strong>describes</strong> a recurring effectful schedule, which runs in some environment <code>Env</code>, after consuming values of type <code>In</code> (errors in the case of <code>retry</code>, or values in the case of <code>repeat</code>) produces values of type <code>Out</code>, and in every step based on input values and the internal state decides to halt or continue after some delay <strong>d</strong>.</p><p>Schedules are defined as a possibly infinite set of intervals spread out over time. Each interval defines a window in which recurrence is possible.</p><p>When schedules are used to repeat or retry effects, the starting boundary of each interval produced by a schedule is used as the moment when the effect will be executed again.</p><p>A variety of other operators exist for transforming and combining schedules, and the companion object for <code>Schedule</code> contains all common types of schedules, both for performing retrying, as well as performing repetition.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="repeat-and-retry">Repeat and Retry<a aria-hidden="true" class="hash-link" href="#repeat-and-retry" title="Direct link to heading">â€‹</a></h2><p>Schedules allow us to define and compose flexible recurrence schedules, which can be used to <strong>repeat</strong> actions, or <strong>retry</strong> actions in the event of errors.</p><p>Repetition and retrying are two similar concepts in the domain of scheduling. It is the same concept and idea, only one of them looks for successes and the other one looks for failures. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="repeat">Repeat<a aria-hidden="true" class="hash-link" href="#repeat" title="Direct link to heading">â€‹</a></h3><p>In the case of repetition, ZIO has a <code>ZIO#repeat</code> function, which takes a schedule as a repetition policy and returns another effect that describes an effect with repetition strategy according to that policy.</p><p>Repeat policies are used in the following functions:</p><ul><li><code>ZIO#repeat</code> â€” Repeats an effect until the schedule is done.</li><li><code>ZIO#repeatOrElse</code> â€” Repeats an effect until the schedule is done, with a fallback for errors.</li></ul><blockquote><p><em><strong>Note:</strong></em></p><p>Scheduled recurrences are in addition to the first execution, so that <code>io.repeat(Schedule.once)</code> yields an effect that executes <code>io</code>, and then if that succeeds, executes <code>io</code> an additional time.</p></blockquote><p>Let&#x27;s see how we can create a repeated effect by using <code>ZIO#repeat</code> function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val action:      ZIO[R, E, A] = ???</span><br></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val repeated = action repeat policy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>There is another version of <code>repeat</code> that helps us to have a fallback strategy in case of erros, if something goes wrong we can handle that by using the <code>ZIO#repeatOrElse</code> function, which helps up to add an <code>orElse</code> callback that will run in case of repetition failure:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span><br></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val orElse: (E, Option[B]) =&gt; ZIO[R1, E2, B] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val repeated = action repeatOrElse (policy, orElse)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="retry">Retry<a aria-hidden="true" class="hash-link" href="#retry" title="Direct link to heading">â€‹</a></h3><p>In the case of retrying, ZIO has a <code>ZIO#retry</code> function, which takes a schedule as a repetition policy and returns another effect that describes an effect with repetition strategy which will retry following the failure of the original effect.</p><p>Repeat policies are used in the following functions:</p><ul><li><code>ZIO#retry</code> â€“ Retries an effect until it succeeds.</li><li><code>ZIO#retryOrElse</code> â€” Retries an effect until it succeeds, with a fallback for errors.</li></ul><p>Let&#x27;s see how we can create a repeated effect by using <code>ZIO#retry</code> function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span><br></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, E, S] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val repeated = action retry policy</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>There is another version of <code>retry</code> that helps us to have a fallback strategy in case of erros, if something goes wrong we can handle that by using the <code>ZIO#retryOrElse</code> function, which helps up to add an <code>orElse</code> callback that will run in case of failure of repetition failure:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val action:       ZIO[R, E, A] = ???</span><br></span><span class="token-line"><span class="token plain">val policy: Schedule[R1, A, B] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val orElse: (E, S) =&gt; ZIO[R1, E1, A1] = ???</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val repeated = action retryOrElse (policy, orElse)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="base-schedules">Base Schedules<a aria-hidden="true" class="hash-link" href="#base-schedules" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="stop">stop<a aria-hidden="true" class="hash-link" href="#stop" title="Direct link to heading">â€‹</a></h3><p>A schedule that does not recur, just stops and returns one <code>Unit</code> element:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val stop = Schedule.stop</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="once">once<a aria-hidden="true" class="hash-link" href="#once" title="Direct link to heading">â€‹</a></h3><p>A schedule that recurs one time an returns one <code>Unit</code> element:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val once = Schedule.once</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="forever">forever<a aria-hidden="true" class="hash-link" href="#forever" title="Direct link to heading">â€‹</a></h3><p>A schedule that always recurs and produces number of recurrence at each run:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val forever = Schedule.forever</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="recurs">recurs<a aria-hidden="true" class="hash-link" href="#recurs" title="Direct link to heading">â€‹</a></h3><p>A schedule that only recurs the specified number of times:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val recurs = Schedule.recurs(5)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="spaced">spaced<a aria-hidden="true" class="hash-link" href="#spaced" title="Direct link to heading">â€‹</a></h3><p>A schedule that recurs continuously, each repetition spaced the specified duration from the last run:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val spaced = Schedule.spaced(10.milliseconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fixed">fixed<a aria-hidden="true" class="hash-link" href="#fixed" title="Direct link to heading">â€‹</a></h3><p>A schedule that recurs on a fixed interval. Returns the number of repetitions of the schedule so far:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val fixed = Schedule.fixed(10.seconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="exponential">exponential<a aria-hidden="true" class="hash-link" href="#exponential" title="Direct link to heading">â€‹</a></h3><p>A schedule that recurs using exponential backoff:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val exponential = Schedule.exponential(10.milliseconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fibonacci">fibonacci<a aria-hidden="true" class="hash-link" href="#fibonacci" title="Direct link to heading">â€‹</a></h3><p>A schedule that always recurs, increasing delays by summing the preceding two delays (similar to the fibonacci sequence). Returns the current duration between recurrences:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val fibonacci = Schedule.fibonacci(10.milliseconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="identity">identity<a aria-hidden="true" class="hash-link" href="#identity" title="Direct link to heading">â€‹</a></h3><p>A schedule that always decides to continue. It recurs forever, without any delay. <code>identity</code> schedule consumes input, and emit the same as output (<code>Schedule[Any, A, A]</code>):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val identity = Schedule.identity[Int]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="unfold">unfold<a aria-hidden="true" class="hash-link" href="#unfold" title="Direct link to heading">â€‹</a></h3><p>A schedule that repeats one time from the specified state and iterator:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val unfold = Schedule.unfold(0)(_ + 1)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="succeed">succeed<a aria-hidden="true" class="hash-link" href="#succeed" title="Direct link to heading">â€‹</a></h3><p>Returns a schedule that repeats one time, producing the specified constant value:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val constant = Schedule.succeed(5)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fromfunction">fromFunction<a aria-hidden="true" class="hash-link" href="#fromfunction" title="Direct link to heading">â€‹</a></h3><p>A schedule that always recurs, mapping input values through the specified function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val inc = Schedule.fromFunction[Int, Int](_ + 1)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schedule-combinators">Schedule Combinators<a aria-hidden="true" class="hash-link" href="#schedule-combinators" title="Direct link to heading">â€‹</a></h2><p>Schedules define stateful, possibly effectful, recurring schedules of events, and compose in a variety of ways. Combinators allow us to take schedules and combine them together to get other schedules and if we have combinators with just the right properties. Then in theory we should be able to solve an infinite number of problems, with only a few combinators and few base schedules.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="composition">Composition<a aria-hidden="true" class="hash-link" href="#composition" title="Direct link to heading">â€‹</a></h3><p>Schedules compose in the following primary ways:</p><ul><li><strong>Union</strong>. This performs the union of the intervals of two schedules.</li><li><strong>Intersection</strong>. This performs the intersection of the intervals of two schedules.</li><li><strong>Sequence</strong>. This concatenates the intervals of one schedule onto another.</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="union">Union<a aria-hidden="true" class="hash-link" href="#union" title="Direct link to heading">â€‹</a></h4><p>Combines two schedules through union, by recurring if either schedule wants to
recur, using the minimum of the two delays between recurrences.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1</code> <!-- -->|<!-- --> <!-- -->|<!-- --> <code>s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, (B, C)]</code></td></tr><tr><td>Continute: <code>Boolean</code></td><td><code>b1</code></td><td><code>b2</code></td><td><code>b1</code> <!-- -->|<!-- --> <!-- -->|<!-- --> <code>b2</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1.min(d2)</code></td></tr><tr><td>Emit: <code>(A, B)</code></td><td><code>a</code></td><td><code>b</code></td><td><code>(a, b)</code></td></tr></tbody></table><p>We can combine two schedule through union with <code>||</code> operator:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val expCapped = Schedule.exponential(100.milliseconds) || Schedule.spaced(1.second)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="intersection">Intersection<a aria-hidden="true" class="hash-link" href="#intersection" title="Direct link to heading">â€‹</a></h4><p>Combines two schedules through the intersection, by recurring only if both schedules want to recur, using the maximum of the two delays between recurrences.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 &amp;&amp; s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, (B, C)]</code></td></tr><tr><td>Continute: <code>Boolean</code></td><td><code>b1</code></td><td><code>b2</code></td><td><code>b1 &amp;&amp; b2</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1.max(d2)</code></td></tr><tr><td>Emit: <code>(A, B)</code></td><td><code>a</code></td><td><code>b</code></td><td><code>(a, b)</code></td></tr></tbody></table><p>We can intersect two schedule with <code>&amp;&amp;</code> operator:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val expUpTo10 = Schedule.exponential(1.second) &amp;&amp; Schedule.recurs(10)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sequence">Sequence<a aria-hidden="true" class="hash-link" href="#sequence" title="Direct link to heading">â€‹</a></h4><p>Combines two schedules sequentially, by following the first policy until it ends, and then following the second policy.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 andThen s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, A, C]</code></td><td><code>Schedule[R, A, C]</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1 + d2</code></td></tr><tr><td>Emit: <code>B</code></td><td><code>a</code></td><td><code>b</code></td><td><code>b</code></td></tr></tbody></table><p>We can sequence two schedule by using <code>andThen</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val sequential = Schedule.recurs(10) andThen Schedule.spaced(1.second)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="piping">Piping<a aria-hidden="true" class="hash-link" href="#piping" title="Direct link to heading">â€‹</a></h3><p>Combine two schedules by piping the output of the first schedule to the input of the other. Effects described by the first schedule will always be executed before the effects described by the second schedule.</p><table><thead><tr><th></th><th><code>s1</code></th><th><code>s2</code></th><th><code>s1 &gt;&gt;&gt; s2</code></th></tr></thead><tbody><tr><td>Type</td><td><code>Schedule[R, A, B]</code></td><td><code>Schedule[R, B, C]</code></td><td><code>Schedule[R, A, C]</code></td></tr><tr><td>Delay: <code>Duration</code></td><td><code>d1</code></td><td><code>d2</code></td><td><code>d1 + d2</code></td></tr><tr><td>Emit: <code>B</code></td><td><code>a</code></td><td><code>b</code></td><td><code>b</code></td></tr></tbody></table><p>We can pipe two schedule by using <code>&gt;&gt;&gt;</code> operator:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val totalElapsed = Schedule.spaced(1.second) &lt;* Schedule.recurs(5) &gt;&gt;&gt; Schedule.elapsed</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="jittering">Jittering<a aria-hidden="true" class="hash-link" href="#jittering" title="Direct link to heading">â€‹</a></h3><p>A <code>jittered</code> is a combinator that takes one schedule and returns another schedule of the same type except for the delay which is applied randomly:</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>jittered</code></td><td></td><td><code>Schedule[Env with Random, In, Out]</code></td></tr><tr><td><code>jittered</code></td><td><code>min: Double, max: Double</code></td><td><code>Schedule[Env with Random, In, Out]</code></td></tr></tbody></table><p>We can jitter any schedule by calling <code>jittered</code> on it:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val jitteredExp = Schedule.exponential(10.milliseconds).jittered</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>When a resource is out of service due to overload or contention, retrying and backing off doesn&#x27;t help us. If all failed API calls are backed off to the same point of time, they cause another overload or contention. Jitter adds some amount of randomness to the delay of the schedule. This helps us to avoid ending up accidentally synchronizing and taking the service down by accident.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="collecting">Collecting<a aria-hidden="true" class="hash-link" href="#collecting" title="Direct link to heading">â€‹</a></h3><p>A <code>collectAll</code> is a combinator that when we call it on a schedule, produces a new schedule that collects the outputs of the first schedule into a chunk.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>collectAll</code></td><td><code>Schedule[Env, In, Out]</code></td><td><code>Schedule[Env, In, Chunk[Out]]</code></td></tr></tbody></table><p>In the following example, we are catching all recurrence of schedule into <code>Chunk</code>, so at the end, it would contain <code>Chunk(0, 1, 2, 3, 4)</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val collect = Schedule.recurs(5).collectAll</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="filtering">Filtering<a aria-hidden="true" class="hash-link" href="#filtering" title="Direct link to heading">â€‹</a></h3><p>We can filter inputs or outputs of a schedule with <code>whileInput</code> and <code>whileOutput</code>. Alse ZIO schedule has an effectful version of these two functions, <code>whileInputZIO</code> and <code>whileOutputZIO</code>.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>whileInput</code></td><td><code>In1 =&gt; Boolean</code></td><td><code>Schedule[Env, In1, Out]</code></td></tr><tr><td><code>whileOutput</code></td><td><code>Out =&gt; Boolean</code></td><td><code>Schedule[Env, In, Out]</code></td></tr><tr><td><code>whileInputZIO</code></td><td><code>In1 =&gt; URIO[Env1, Boolean]</code></td><td><code>Schedule[Env1, In1, Out]</code></td></tr><tr><td><code>whileOutputZIO</code></td><td><code>Out =&gt; URIO[Env1, Boolean]</code></td><td><code>Schedule[Env1, In, Out]</code></td></tr></tbody></table><p>In following example we collect all emiting outputs before reaching the 5 output, so it would return <code>Chunk(0, 1, 2, 3, 4)</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val res = Schedule.unfold(0)(_ + 1).whileOutput(_ &lt; 5).collectAll</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mapping">Mapping<a aria-hidden="true" class="hash-link" href="#mapping" title="Direct link to heading">â€‹</a></h3><p>There are two versions for mapping schedules, <code>map</code> and its effectful version <code>mapZIO</code>.</p><table><thead><tr><th>Function</th><th>Input Type</th><th>Output Type</th></tr></thead><tbody><tr><td><code>map</code></td><td><code>f: Out =&gt; Out2</code></td><td><code>Schedule[Env, In, Out2]</code></td></tr><tr><td><code>mapZIO</code></td><td><code>f: Out =&gt; URIO[Env1, Out2]</code></td><td><code>Schedule[Env1, In, Out2]</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="leftright-ap">Left/Right Ap<a aria-hidden="true" class="hash-link" href="#leftright-ap" title="Direct link to heading">â€‹</a></h3><p>Sometimes when we intersect two schedules with the <code>&amp;&amp;</code> operator, we just need to ignore the left or the right output. </p><ul><li><ul><li><code>*&gt;</code> ignore the left output </li></ul></li><li><ul><li><code>&lt;*</code> ignore the right output</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="modifying">Modifying<a aria-hidden="true" class="hash-link" href="#modifying" title="Direct link to heading">â€‹</a></h3><p>Modifies the delay of a schedule:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val boosted = Schedule.spaced(1.second).delayed(_ =&gt; 100.milliseconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tapping">Tapping<a aria-hidden="true" class="hash-link" href="#tapping" title="Direct link to heading">â€‹</a></h3><p>Whenever we need to effectfully process each schedule input/output, we can use <code>tapInput</code> and <code>tapOutput</code>.</p><p>We can use these two functions for logging purposes:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val tappedSchedule = Schedule.count.whileOutput(_ &lt; 5).tapOutput(o =&gt; Console.printLine(s&quot;retrying $o&quot;).orDie)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="examples">Examples<a aria-hidden="true" class="hash-link" href="#examples" title="Direct link to heading">â€‹</a></h2><p>Stops retrying after a specified amount of time has elapsed:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">val expMaxElapsed = (Schedule.exponential(10.milliseconds) &gt;&gt;&gt; Schedule.elapsed).whileOutput(_ &lt; 30.seconds)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Retry only when a specific exception occurs:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI scala"><pre tabindex="0" class="prism-code language-scala codeBlock_rtdJ thin-scrollbar"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">import scala.concurrent.TimeoutException</span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">val whileTimeout = Schedule.exponential(10.milliseconds) &amp;&amp; Schedule.recurWhile[Throwable] {</span><br></span><span class="token-line"><span class="token plain">  case _: TimeoutException =&gt; true</span><br></span><span class="token-line"><span class="token plain">  case _ =&gt; false</span><br></span><span class="token-line"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/zio/zio/edit/series/2.x/docs/datatypes/misc/schedule.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/next/datatypes/misc/chunk"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Chunk</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/next/datatypes/misc/supervisor"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Supervisor<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#repeat-and-retry" class="table-of-contents__link toc-highlight">Repeat and Retry</a><ul><li><a href="#repeat" class="table-of-contents__link toc-highlight">Repeat</a></li><li><a href="#retry" class="table-of-contents__link toc-highlight">Retry</a></li></ul></li><li><a href="#base-schedules" class="table-of-contents__link toc-highlight">Base Schedules</a><ul><li><a href="#stop" class="table-of-contents__link toc-highlight">stop</a></li><li><a href="#once" class="table-of-contents__link toc-highlight">once</a></li><li><a href="#forever" class="table-of-contents__link toc-highlight">forever</a></li><li><a href="#recurs" class="table-of-contents__link toc-highlight">recurs</a></li><li><a href="#spaced" class="table-of-contents__link toc-highlight">spaced</a></li><li><a href="#fixed" class="table-of-contents__link toc-highlight">fixed</a></li><li><a href="#exponential" class="table-of-contents__link toc-highlight">exponential</a></li><li><a href="#fibonacci" class="table-of-contents__link toc-highlight">fibonacci</a></li><li><a href="#identity" class="table-of-contents__link toc-highlight">identity</a></li><li><a href="#unfold" class="table-of-contents__link toc-highlight">unfold</a></li><li><a href="#succeed" class="table-of-contents__link toc-highlight">succeed</a></li><li><a href="#fromfunction" class="table-of-contents__link toc-highlight">fromFunction</a></li></ul></li><li><a href="#schedule-combinators" class="table-of-contents__link toc-highlight">Schedule Combinators</a><ul><li><a href="#composition" class="table-of-contents__link toc-highlight">Composition</a></li><li><a href="#piping" class="table-of-contents__link toc-highlight">Piping</a></li><li><a href="#jittering" class="table-of-contents__link toc-highlight">Jittering</a></li><li><a href="#collecting" class="table-of-contents__link toc-highlight">Collecting</a></li><li><a href="#filtering" class="table-of-contents__link toc-highlight">Filtering</a></li><li><a href="#mapping" class="table-of-contents__link toc-highlight">Mapping</a></li><li><a href="#leftright-ap" class="table-of-contents__link toc-highlight">Left/Right Ap</a></li><li><a href="#modifying" class="table-of-contents__link toc-highlight">Modifying</a></li><li><a href="#tapping" class="table-of-contents__link toc-highlight">Tapping</a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item">
                <img src="/img/navbar_brand.png" alt="zio">
            </li></ul></div><div class="col footer__col"><div class="footer__title">Github</div><ul class="footer__items"><li class="footer__item">
              <a href="https://github.com/zio/zio">
                <img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github">
              </a>
            </li></ul></div><div class="col footer__col"><div class="footer__title">Chat with us on Discord</div><ul class="footer__items"><li class="footer__item">
                <a href="https://discord.gg/2ccFBr4">
                  <img src="https://img.shields.io/discord/629491597070827530?logo=discord&style=social" alt="discord">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Follow us on Twitter</div><ul class="footer__items"><li class="footer__item">
                <a href="https://twitter.com/zioscala">
                  <img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&style=social" alt="twitter">
                </a>
              </li></ul></div><div class="col footer__col"><div class="footer__title">Additional resources</div><ul class="footer__items"><li class="footer__item"><a href="https://javadoc.io/doc/dev.zio/zio_2.12/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Scaladoc of ZIO<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 ZIO Maintainers - Built with <a href="https://v2.docusaurus.io/">Docusaurus v2</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.7f3e08ea.js"></script>
<script src="/assets/js/main.84c81040.js"></script>
</body>
</html>